{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"atexit"},{"kind":"text","text":"("},{"kind":"externalParam","text":"func"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"GVoidFunc","preciseIdentifier":"c:@T@GVoidFunc"},{"kind":"text","text":"?)"}],"languages":["swift"],"platforms":["macOS"]}]},{"kind":"content","content":[{"anchor":"discussion","level":2,"type":"heading","text":"Discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Since GLib 2.8.2, on Windows "},{"type":"codeVoice","code":"g_atexit()"},{"type":"text","text":" actually is a preprocessor"},{"type":"text","text":" "},{"type":"text","text":"macro that maps to a call to the "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":" function in the C"},{"type":"text","text":" "},{"type":"text","text":"library. This means that in case the code that calls "},{"type":"codeVoice","code":"g_atexit()"},{"type":"text","text":","},{"type":"text","text":" "},{"type":"text","text":"i.e. "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":", is in a DLL, the function will be called when the"},{"type":"text","text":" "},{"type":"text","text":"DLL is detached from the program. This typically makes more sense"},{"type":"text","text":" "},{"type":"text","text":"than that the function is called when the GLib DLL is detached,"},{"type":"text","text":" "},{"type":"text","text":"which happened earlier when "},{"type":"codeVoice","code":"g_atexit()"},{"type":"text","text":" was a function in the GLib"},{"type":"text","text":" "},{"type":"text","text":"DLL."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The behaviour of "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":" in the context of dynamically loaded"},{"type":"text","text":" "},{"type":"text","text":"modules is not formally specified and varies wildly."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"On POSIX systems, calling "},{"type":"codeVoice","code":"g_atexit()"},{"type":"text","text":" (or "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":") in a dynamically"},{"type":"text","text":" "},{"type":"text","text":"loaded module which is unloaded before the program terminates might"},{"type":"text","text":" "},{"type":"text","text":"well cause a crash at program exit."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Some POSIX systems implement "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":" like Windows, and have each"},{"type":"text","text":" "},{"type":"text","text":"dynamically loaded module maintain an own atexit chain that is"},{"type":"text","text":" "},{"type":"text","text":"called when the module is unloaded."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"On other POSIX systems, before a dynamically loaded module is"},{"type":"text","text":" "},{"type":"text","text":"unloaded, the registered atexit functions (if any) residing in that"},{"type":"text","text":" "},{"type":"text","text":"module are called, regardless where the code that registered them"},{"type":"text","text":" "},{"type":"text","text":"resided. This is presumably the most robust approach."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"As can be seen from the above, for portability itâ€™s best to avoid"},{"type":"text","text":" "},{"type":"text","text":"calling "},{"type":"codeVoice","code":"g_atexit()"},{"type":"text","text":" (or "},{"type":"codeVoice","code":"atexit()"},{"type":"text","text":") except in the main executable of a"},{"type":"text","text":" "},{"type":"text","text":"program."}]},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"atexit is deprecated:"}]},{"type":"text","text":" "},{"type":"text","text":"It is best to avoid g_atexit()."}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/glib\/atexit(func:)"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/GLib\/documentation\/GLib\/atexit(func:)","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Specifies a function to be called at normal program termination."}],"kind":"symbol","metadata":{"role":"symbol","title":"atexit(func:)","roleHeading":"Function","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"atexit"},{"kind":"text","text":"("},{"kind":"externalParam","text":"func"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"GVoidFunc","preciseIdentifier":"c:@T@GVoidFunc"},{"kind":"text","text":"?)"}],"symbolKind":"func","externalID":"s:4GLib6atexit4funcyyyXCSg_tF","modules":[{"name":"GLib"}],"platforms":[]},"hierarchy":{"paths":[["doc:\/\/GLib\/documentation\/GLib"]]},"references":{"doc://GLib/documentation/GLib/atexit(func:)":{"role":"symbol","title":"atexit(func:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"atexit"},{"kind":"text","text":"("},{"kind":"externalParam","text":"func"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"GVoidFunc","preciseIdentifier":"c:@T@GVoidFunc"},{"kind":"text","text":"?)"}],"abstract":[{"type":"text","text":"Specifies a function to be called at normal program termination."}],"identifier":"doc:\/\/GLib\/documentation\/GLib\/atexit(func:)","kind":"symbol","type":"topic","deprecated":true,"url":"\/documentation\/glib\/atexit(func:)"},"doc://GLib/documentation/GLib":{"role":"collection","title":"GLib","abstract":[],"identifier":"doc:\/\/GLib\/documentation\/GLib","kind":"symbol","type":"topic","url":"\/documentation\/glib"}}}